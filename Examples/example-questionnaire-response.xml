<?xml version="1.0" encoding="UTF-8"?>
<Bundle xmlns="http://hl7.org/fhir"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://hl7.org/fhir file:/C:/Users/Marten/OneDrive%20-%20Firely/FHIR/Schemas/R4/bundle.xsd">  
  <type value="collection"/>
  <!-- Mappings to data sheet variables are in the comments -->
  <entry>
    <fullUrl value="http://example.org/fhir/QuestionnaireResponse/1"/>
    <resource>
      <QuestionnaireResponse>
        <id value="1"/>
        <status value="completed"/>
        <subject>
          <reference value="http://example.org/fhir/Patient/1"/>
        </subject>        
        <authored value="2020-12-15T12:00:00+01:00"/>
        <author>
          <reference value="http://example.org/fhir/Practitioner/1"/>
        </author>        
        <item>
          <linkId value="Q1"/>
          <text value="Procedure details"/>
          <answer>
            <valueReference>
              <reference value="http://example.org/fhir/Procedure/1"/>
            </valueReference>
          </answer>
        </item>      
        <item>
          <linkId value="Q2"/>
          <text value="Current and past illnesses (multiple choice allowed - plus text with detailed specification)"/>
          <!-- variable no. : 9 -->
          <answer>
            <valueCoding>
              <system value="http://example.org/fhir/CodeSystem/some-condition-codesystem"/> <!-- maybe ICD-10?  -->
              <code value="some-condition-code"/>
            </valueCoding>
          </answer>
        </item>  
        <item>
          <linkId value="Q2"/>
          <text value="Medication Use"/>
          <!-- MedicationStatement, or just a coding? -->
          <answer>
            <!-- variable no. : 10 -->
            <valueCoding>
              <system value="http://example.org/fhir/CodeSystem/some-medication-codesystem"/> 
              <code value="some-medication-code"/>
            </valueCoding>
          </answer>
        </item>
        <item>
          <linkId value="Q3"/>         
          <item>
            <linkId value="Q3.1"/>
            <text value="Emptying agent"/>
            <answer>
              <!-- variable no. : 11 -->
              <valueCoding>
                <system value="http://example.org/fhir/CodeSystem/some-medication-codesystem"/> 
                <code value="some-medication-code"/>
              </valueCoding>
            </answer>
          </item>
          <item>
            <linkId value="Q3.2"/>
            <text value="Taken as a split dose?"/>
            <!-- variable no. : 12 -->
            <answer>
              <valueBoolean value="true"/>
            </answer>
          </item>
        </item>
        <item>
          <linkId value="Q4"/>
          <text value="How far did you get in the colon?"></text>
          <answer>
            <!-- variable no. : 13 -->
            <valueCoding>
              <system value="http://example.org/fhir/CodeSystem/some-codesystem"/> 
              <code value="caecum"/>
            </valueCoding>            
          </answer>         
        </item>
        <item>
          <!-- variable no. : 14 -->
          <linkId value="Q5"/>
          <text value="Was it indicated to intubate the caecum?"></text>
          <answer>
            <valueBoolean value="true"/>                      
          </answer>         
        </item>
        <item>        
          <linkId value="Q6"/>
          <text value="Time for scope withdrawal"/>
          <answer>
            <!-- variable no. : 16 -->
            <valueQuantity>
              <value value="5"/>
              <unit value="min"/>
              <system value="http://unitsofmeasure.org"/>
              <code value="min"/>              
            </valueQuantity>
          </answer>
        </item>
        <item>
          <linkId value="Q7"/>
          <!-- variable no. : 17 -->
          <text value="Photo documentation that the caecum has been reached"/>
          <answer>
            <valueBoolean value="true"/>
          </answer>
        </item>      
        <item>
          <linkId value="Q8"/>
          <!-- variable no. : 27 -->
          <text value="Segment where mucusal biopsy was made"/>
          <answer>
            <valueCoding>
              <system value="http://example.org/fhir/CodeSystem/some-codesystem"/> 
              <code value="caecum"/>
            </valueCoding>
          </answer>         
        </item>
        <item>
          <linkId value="Q9"/>
          <!-- variable no. : 29 -->
          <text value="Photo documentation of all findings?"/>
          <answer>
            <valueCoding>
              <system value="http://example.org/fhir/CodeSystem/some-codesystem"/> 
              <code value="caecum"/>
            </valueCoding>
          </answer>         
        </item>
        <item>
          <linkId value="Q10"/>
          <!-- variable no. : 18 -->
          <text value="Emptying Quality right colon"/>
          <answer>
            <valueCoding>
              <system value="http://example.org/fhir/CodeSystem/some-codesystem"/> 
              <code value="1"/>
            </valueCoding>
          </answer>         
        </item>
        <item>
          <linkId value="Q11"/>
          <!-- variable no. : 19 -->
          <text value="Emptying Quality transversum"/>
          <answer>
            <valueCoding>
              <system value="http://example.org/fhir/CodeSystem/some-codesystem"/> 
              <code value="2"/>
            </valueCoding>
          </answer>         
        </item>
        <item>
          <linkId value="Q12"/>
          <!-- variable no. : 20 -->
          <text value="Emptying Quality left colon"/>
          <answer>
            <valueCoding>
              <system value="http://example.org/fhir/CodeSystem/some-codesystem"/> 
              <code value="1"/>
            </valueCoding>
          </answer>         
        </item>      
        <item>
          <linkId value="Q13"/>
          <!-- variable no. : 20 -->
          <text value="Was the colonoscopy carried out under general anesthesia?"/>
          <answer>
            <valueBoolean value="true"/>
          </answer>         
        </item>      
        <item>
          <linkId value="Q14"/>
          <!-- variable no. : 33 -->
          <text value="Was a clean colon achieved?"/>
          <answer>
            <valueBoolean value="true"/>
          </answer>         
        </item>      
      </QuestionnaireResponse>
    </resource>
  </entry>
  <entry>
    <fullUrl value="http://example.org/fhir/Practitioner/1"/>
    <resource>
      <Practitioner>
        <id value="1"/>
        <identifier>
          <system value="http://hl7.no/fhir/NamingSystem/HPR"/>
          <value value="465783649328"/>
        </identifier>
      </Practitioner>
    </resource>
  </entry>
  <entry>
    <fullUrl value="http://example.org/fhir/Patient/1"/>
    <resource>
      <Patient>
        <id value="1"/>
        <identifier>
          <system value="http://hl7.no/fhir/NamingSystem/FNR"/>
          <value value="536271738293"/>
        </identifier>
      </Patient>
    </resource>
  </entry>
  <entry>    
    <fullUrl value="http://example.org/fhir/Procedure/1"/>
    <resource>
      <Procedure>   
        <!-- variable no. : 7 -->
        <identifier>
          <system value="http://example.org/fhir/NamingSystem/scope-id"/>
          <value value="123374849"/>
        </identifier>        
        <status value="completed"/>
        <!-- variable no. : 36 -->
        <code>
          <coding>
            <system value="ncsp-code-system/"/>
            <code value="colonoscopy"/>
          </coding>
        </code>
        <subject>
          <reference value="http://example.org/fhir/Patient/1"/>
        </subject>
        <!-- variable no. : 2 -->
        <performedDateTime value="2020-11-01T15:00:00+01:00"/>
        <!-- variable no. : 3,4,5 -->
        <performer>
          <function>
            <text value="colonoscopist"/>
            <!-- some role code for colonoscopist -->
          </function>
          <actor>
            <reference value="http://example.org/fhir/Practitioner/2"/>
          </actor>          
        </performer>
        <performer>
          <function>
            <text value="Nurse"/>
            <!-- some role code for nurse -->
          </function>
          <actor>
            <reference value="http://example.org/fhir/Practitioner/3"/>
          </actor>          
        </performer>
        <!-- variable no. : 1 -->
        <location>
          <identifier>
            <system value="http://example.org/fhir/CodeSystem/some-codesystem"/>
            <value value="6738264923"/>
          </identifier>
        </location>
        <!-- variable no. : 14 -->
        <reasonCode>
          <text value="Incomplete previous colonoscopy"/>
          <!-- replace with proper coding -->
        </reasonCode>
        <report>
          <reference value="http://example.org/fhir/DiagnosticReport/1"/>
        </report>        
        <complication>
          <!-- variable no. : 31 -->
          <extension url="http://hl7.no/fhir/extension-complication-consequence">
            <valueCoding>
              <system value="http://example.org/fhir/CodeSystem/some-codesystem"/> 
              <code value="hospitalization"/>
            </valueCoding>
          </extension>
          <!-- variable no. : 30 -->
          <coding>
            <system value="http://example.org/fhir/CodeSystem/some-codesystem"/> 
            <code value="bleeding"/>
          </coding>
        </complication>
        <!-- variable no. : 37 -->
        <followUp>
          <coding>
            <system value="http://example.org/fhir/some-valueset"/>
            <code value="CT kolografi"/>
          </coding>
          <!-- variable no. : 38 -->
          <text value="the patient needs a CT for further diagnostics"/>
        </followUp>
      </Procedure>
    </resource>
  </entry>
  <entry>
    <fullUrl value="http://example.org/fhir/MedicationStatement/1"/>
    <resource>     
      <MedicationStatement>
        <!-- variable no. : 21 -->
        <partOf>
          <reference value="http://example.org/fhir/Procedure/1"/>
        </partOf>
        <status value="active"/>
        <medicationCodeableConcept>
          <coding>
            <system value="http://example.org/fhir/CodeSystem/some-codesystem"/>
            <code value="Afentanil"/>
          </coding>
        </medicationCodeableConcept>
        <subject>
          <reference value="http://example.org/fhir/Patient/1"></reference>
        </subject>
        <effectiveDateTime value="2020-12-15"/>
        <dosage>
          <doseAndRate>
            <doseQuantity>
              <value value="10"/>
              <unit value="mg"/>
              <system value="http://unitsofmeasure.org"/>
              <code value="mg"/>      
            </doseQuantity>               
          </doseAndRate>
        </dosage>
      </MedicationStatement>
    </resource>
  </entry>
  <entry>   
    <fullUrl value="http://example.org/fhir/DiagnosticReport/1"/>
    <resource>
      <DiagnosticReport>
        <status value="final"/>
        <code>
          <text value="colonoscopy report"/>
          <!-- replace with proper coding -->
        </code>
        <subject>
          <reference value="http://example.org/fhir/Patient/1"/>
        </subject>
        <result>
          <reference value="http://hl7.org/fhir/Observation/lesion-1"/>
        </result>
        <result>
          <reference value= "http://example.org/fhir/Observation/mucosa/"/>
        </result>
        <!-- variable no. : 34, 35 -->
        <conclusionCode>
          <coding>
            <system value="http://hl7.org/fhir/sid/icd-10"/>
            <code value="C18.0"/>
            <display value="Malignant neoplasm of colon - Caecum"/>
          </coding>
        </conclusionCode>
      </DiagnosticReport>        
    </resource>
  </entry>
  <entry>
    <fullUrl value="http://example.org/fhir/Observation/lesion-1"/>
    <resource>     
      <Observation>
        <!-- variable no. : 24,25 -->
        <status value="final"/>
        <code>
          <!-- need proper coding to replace this -->
          <text value="lesion"/>
        </code>        
        <note>
          <text value="free text field"></text>
        </note>
        <bodySite>       
            <coding>
              <system value="http://example.org/fhir/some-codesystem"/>
              <code value="ascending"/>          
            </coding>         
        </bodySite>
        <component>
          <code>
            <text value="morphology"/>            
          </code>
          <valueCodeableConcept>
            <text value="II b Flat"/>
          </valueCodeableConcept>
        </component>
        <component>
          <code>
            <text value="Size in diameter (mm)"/>            
          </code>
          <valueQuantity>
            <value value="3"/>
            <unit value="mm"/>
            <system value="http://unitsofmeasure.org"/>
            <code value="mm"/>
          </valueQuantity>
        </component>
        <component>
          <code>
            <text value="Method for removing or tissue sample"/>            
          </code>
          <valueCodeableConcept>
            <text value="Biopsy Tang"/>
          </valueCodeableConcept>
        </component>
        <component>
          <code>
            <text value="Is the lesion endoscopic complete removed (one choice)"/>            
          </code>
          <valueCodeableConcept>
            <text value="no"/>
          </valueCodeableConcept>
        </component>
        <component>
          <code>
            <text value="Cancersuspect lesion"/>            
          </code>
          <valueCodeableConcept>
            <text value="no"/>
          </valueCodeableConcept>
        </component>       
        <component>
          <code>
            <text value="Tissue sample sent to pathologist"/>            
          </code>
          <valueBoolean value="true"/>         
        </component>        
      </Observation>
    </resource>
  </entry> 
  <entry>
    <fullUrl value="http://example.org/fhir/Observation/mucosa/"/>
    <resource>
      <Observation>
        <status value="final"/>
        <code>
          <!-- need proper coding to replace this -->
          <text value="Mucosa"/>
        </code>
        <!-- variable no. : 26 -->
        <valueCodeableConcept>
          <!-- need proper coding to replace this -->
          <text value="Normal"/>
        </valueCodeableConcept>
      </Observation>
    </resource>
  </entry>
  <entry>
    <fullUrl value="http://example.org/fhir/Practitioner/2"/>
    <resource>
      <Practitioner>
        <id value="2"/>
        <identifier>
          <system value="http://hl7.no/fhir/NamingSystem/HPR"/>
          <value value="63784293743"/>
        </identifier>
      </Practitioner>
    </resource>
  </entry>
  <entry>
    <fullUrl value="http://example.org/fhir/Practitioner/3"/>
    <resource>
      <Practitioner>
        <id value="3"/>
        <identifier>
          <system value="http://hl7.no/fhir/NamingSystem/HPR"/>
          <value value="63784293743"/>
        </identifier>
      </Practitioner>
    </resource>
  </entry>
</Bundle>